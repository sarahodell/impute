haplotypes directory contains R scripts for running imputation pipeline, calculating IBD, and then generating haplotype probabilities from genotype probabilities.

Files:

control_file.R - script for creating R/qtl2 json control files

fix_pmap.R - simple script to convert physical map file positions from Mb to bp

founder_alleles.R - filters the founder allele data to remove sites that are multi-allelic or that are discordant between the WGS and 600K array data. Converts genotype information to 0s and 1s, and writes out to a tab-delimited file. Currently takes in chromosome number (1..10) as an argument.

get_ibd.R - takes in chromosome {1..10} as an argument. Uses R/qtl2 to calculate the IBD regions between the 16 founders.

ibd_blocks.R - takes in chromosome {1..10} as an argument. Uses the IBD segments generated by get_ibd.R to separate distinct haplotypes blocks based off of pairwise ibd and to generate haplotype probabilities for the DH lines using the genotype probabilities, and saves an R object of adjacency matrices for each block, which tells you which founders were in IBD with one another in a particular block.

qtl2_array.R - runs R/qtl2 for one chromosome (argument) and calculates genotype probabilities for the DH lines

wgs_alleleprobs.R - Uses the genotype probabilities and data on founder alleles to impute WGS data from the founders onto the DH lines. Writes out a tab-delimited file of the allele probabilities (value is probabiltiies of having allele 1 at that position) for all of the lines. Runs for one chromosome (argument)
